<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Help Lilia Get to Tanzania - Mission Trip Fundraiser</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Dancing+Script:wght@600&display=swap" rel="stylesheet">
    
    <!-- Security Headers -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; connect-src 'self' https://script.google.com; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:;">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    
    <style>
        :root {
            --primary: #8e44ad;
            --primary-light: #9b59b6;
            --secondary: #e84393;
            --accent: #3498db;
            --success: #2ecc71;
            --light: #f8f9fa;
            --dark: #2c3e50;
            --text: #555;
            --shadow: 0 10px 30px rgba(0,0,0,0.1);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            color: var(--text);
            line-height: 1.6;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            background: white;
            padding: 40px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 8px;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
        }

        .header h1 {
            font-size: 2.8rem;
            color: var(--primary);
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header h2 {
            color: var(--secondary);
            font-size: 1.5rem;
            margin-bottom: 25px;
            font-weight: 500;
        }

        .mission-info {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin: 25px 0;
            position: relative;
            border-left: 4px solid var(--accent);
        }

        .mission-info h3 {
            color: var(--primary);
            margin-bottom: 15px;
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .mission-info h3 i {
            color: var(--secondary);
        }

        .mission-info p {
            margin-bottom: 15px;
        }

        .highlight-box {
            background: linear-gradient(135deg, rgba(142, 68, 173, 0.1), rgba(232, 67, 147, 0.1));
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            border: 1px dashed var(--primary);
        }

        .admin-panel {
            background: white;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            border-top: 4px solid var(--primary);
        }

        .admin-toggle {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 50px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
            width: fit-content;
            transition: var(--transition);
        }

        .admin-toggle:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(142, 68, 173, 0.3);
        }

        .admin-content {
            display: none;
            padding-top: 20px;
            border-top: 1px solid #eee;
        }

        .admin-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-group textarea, .form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            font-family: 'Poppins', sans-serif;
            transition: var(--transition);
        }

        .form-group textarea:focus, .form-group input:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 3px rgba(142, 68, 173, 0.2);
        }

        .form-group textarea {
            min-height: 120px;
            resize: vertical;
        }

        .fundraiser-card {
            background: white;
            border-radius: 15px;
            padding: 40px;
            box-shadow: var(--shadow);
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .fundraiser-card.completed {
            background: linear-gradient(135deg, var(--success), #27ae60);
            color: white;
        }

        .fundraiser-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .profile-container {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
        }

        .profile-image {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 3rem;
            font-weight: 600;
            border: 5px solid white;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .fundraiser-name {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 15px;
            color: var(--primary);
            cursor: pointer;
            font-family: 'Dancing Script', cursive;
        }

        .fundraiser-bio {
            color: var(--text);
            font-size: 1.1rem;
            margin-bottom: 30px;
            line-height: 1.8;
            max-width: 700px;
            margin-left: auto;
            margin-right: auto;
            font-style: italic;
        }

        .progress-section {
            margin-bottom: 30px;
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
        }

        .progress-bar {
            width: 100%;
            height: 25px;
            background: #ecf0f1;
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 15px;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.1);
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary), var(--secondary));
            transition: width 0.5s ease;
            border-radius: 15px;
            position: relative;
            overflow: hidden;
        }

        .progress-fill::after {
            content: "";
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: progressShine 2s infinite;
        }

        @keyframes progressShine {
            100% {
                left: 100%;
            }
        }

        .progress-text {
            text-align: center;
            font-weight: 700;
            font-size: 1.3rem;
            margin-bottom: 8px;
            color: var(--dark);
        }

        .progress-percentage {
            text-align: center;
            font-size: 1.1rem;
            color: var(--primary);
            font-weight: 600;
        }

        .number-section {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 12px;
            margin-bottom: 30px;
        }

        .section-title {
            font-size: 1.4rem;
            color: var(--primary);
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .number-grid {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 10px;
            margin-bottom: 25px;
        }

        .number-button {
            aspect-ratio: 1;
            border: 2px solid var(--accent);
            background: white;
            color: var(--accent);
            border-radius: 10px;
            cursor: pointer;
            font-weight: 700;
            transition: var(--transition);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.1rem;
            box-shadow: 0 3px 6px rgba(0,0,0,0.05);
        }

        .number-button:hover {
            background: var(--accent);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }

        .number-button.selected {
            background: var(--success);
            border-color: var(--success);
            color: white;
            transform: scale(1.05);
        }

        .number-button.donated {
            background: #bdc3c7;
            border-color: #95a5a6;
            color: white;
            cursor: not-allowed;
            transform: none;
        }

        .donation-summary {
            background: linear-gradient(135deg, rgba(142, 68, 173, 0.1), rgba(232, 67, 147, 0.1));
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 25px;
            text-align: center;
            border: 1px solid var(--primary-light);
        }

        .donation-summary h3 {
            font-size: 1.5rem;
            color: var(--primary);
        }

        .payment-methods {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        .payment-btn {
            padding: 20px 15px;
            border: 2px solid #e0e0e0;
            background: white;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: var(--transition);
            text-align: center;
            font-size: 1.1rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .payment-btn:hover {
            border-color: var(--accent);
            background: #f8f9fa;
            transform: translateY(-3px);
        }

        .payment-btn.selected {
            border-color: var(--success);
            background: var(--success);
            color: white;
            transform: scale(1.02);
        }

        .payment-icon {
            font-size: 2rem;
        }

        .donate-btn {
            width: 100%;
            padding: 18px;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 1.3rem;
            font-weight: 700;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 5px 15px rgba(142, 68, 173, 0.3);
            letter-spacing: 0.5px;
        }

        .donate-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(142, 68, 173, 0.4);
        }

        .donate-btn:disabled {
            background: #bdc3c7;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
            overflow-y: auto;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 40px;
            border-radius: 20px;
            max-width: 550px;
            width: 90%;
            text-align: center;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
        }

        .close-btn {
            position: absolute;
            top: 20px;
            right: 25px;
            font-size: 30px;
            cursor: pointer;
            color: #999;
            transition: var(--transition);
        }

        .close-btn:hover {
            color: var(--primary);
            transform: rotate(90deg);
        }

        .success-message {
            background: linear-gradient(135deg, var(--success), #27ae60);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
            font-size: 1.2rem;
        }

        .status-indicator {
            padding: 12px;
            border-radius: 8px;
            margin: 15px 0;
            text-align: center;
            font-weight: 600;
        }

        .status-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .auth-form {
            background: #fff3cd;
            border: 1px solid #ffeeba;
            padding: 25px;
            border-radius: 12px;
            margin: 20px 0;
        }

        .form-btn {
            padding: 12px 25px;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: var(--transition);
            width: 100%;
            margin-top: 10px;
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--primary), var(--primary-light));
        }

        .btn-primary:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(142, 68, 173, 0.3);
        }

        .btn-danger {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }

        .btn-danger:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.3);
        }

        .btn-success {
            background: linear-gradient(135deg, var(--success), #27ae60);
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .header {
                padding: 30px 20px;
            }
            
            .header h1 {
                font-size: 2.2rem;
            }
            
            .number-grid {
                grid-template-columns: repeat(5, 1fr);
            }
            
            .payment-methods {
                grid-template-columns: 1fr;
            }
            
            .fundraiser-card {
                padding: 30px 20px;
            }
            
            .modal-content {
                padding: 30px 20px;
            }
        }

        @media (max-width: 480px) {
            .number-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .header h1 {
                font-size: 1.8rem;
            }
            
            .header h2 {
                font-size: 1.2rem;
            }
        }

        .floating-element {
            position: absolute;
            z-index: -1;
            opacity: 0.1;
        }

        .floating-1 {
            top: 10%;
            left: 5%;
            font-size: 5rem;
            color: var(--primary);
            animation: float 15s infinite linear;
        }

        .floating-2 {
            top: 20%;
            right: 5%;
            font-size: 4rem;
            color: var(--secondary);
            animation: float 18s infinite linear reverse;
        }

        .floating-3 {
            bottom: 20%;
            left: 10%;
            font-size: 3.5rem;
            color: var(--accent);
            animation: float 12s infinite linear;
        }

        @keyframes float {
            0% {
                transform: translateY(0) rotate(0deg);
            }
            50% {
                transform: translateY(-20px) rotate(180deg);
            }
            100% {
                transform: translateY(0) rotate(360deg);
            }
        }
    </style>
</head>
<body>
    <div class="floating-element floating-1"><i class="fas fa-heart"></i></div>
    <div class="floating-element floating-2"><i class="fas fa-globe-africa"></i></div>
    <div class="floating-element floating-3"><i class="fas fa-hands-helping"></i></div>
    
    <div class="container">
        <div class="header">
            <h1><i class="fas fa-globe-africa"></i> Help Lilia Get to Tanzania</h1>
            <h2>Mission Trip to Arusha ‚Ä¢ November 20-30, 2025</h2>
            <div class="mission-info">
                <h3><i class="fas fa-bullseye"></i> Our Mission</h3>
                <p>We'll be ministering to over 107,000 children in Arusha, Tanzania and conducting projects at a local school (possibly painting classrooms, fixing desks, and other vital improvements to create a better learning environment).</p>
                <p><strong>Your donation helps cover:</strong> Flights, accommodation, meals, project supplies, and materials for the children.</p>
                <div class="highlight-box">
                    <p><strong><i class="fas fa-lightbulb"></i> How to Donate:</strong> "Pick A Number" to represent the donation amount that you would like to give (you can choose multiple numbers to get the sum of your choice). Afterwards, scroll to the bottom to select payment option and press "Next".</p>
                </div>
            </div>
        </div>

        <div class="admin-panel" id="adminPanel" style="display: none;">
            <button class="admin-toggle" onclick="toggleAdmin()">
                <i class="fas fa-tools"></i> Admin Panel
            </button>
            <div class="admin-content" id="adminContent">
                <h3><i class="fas fa-user-shield"></i> Admin Dashboard - Lilia</h3>
                
                <!-- Admin Authentication -->
                <div class="auth-form" id="authForm">
                    <h4><i class="fas fa-lock"></i> Admin Authentication Required</h4>
                    <div class="form-group">
                        <label><i class="fas fa-key"></i> Admin Password:</label>
                        <input type="password" id="adminPassword" placeholder="Enter admin password">
                        <button class="form-btn btn-primary" onclick="authenticateAdmin()">
                            <i class="fas fa-unlock"></i> Unlock Admin Panel
                        </button>
                    </div>
                    <div id="authError" class="status-indicator status-error" style="display: none;"></div>
                </div>

                <div id="adminDashboard" style="display: none;">
                    <div class="form-group">
                        <label><i class="fas fa-chart-line"></i> Stats</label>
                        <p><strong>Total Donations:</strong> <span id="donationCount">0</span></p>
                        <p><strong>Total Raised:</strong> $<span id="totalRaised">0</span></p>
                        <p><strong>Last Updated:</strong> <span id="lastUpdated">Never</span></p>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-edit"></i> Update Your Bio</label>
                        <textarea id="bioText" maxlength="500">I'm passionate about serving others and making a difference in the lives of children. This Tanzania mission is close to my heart!</textarea>
                        <button class="form-btn btn-primary" onclick="updateBio()">
                            <i class="fas fa-save"></i> Update Bio
                        </button>
                    </div>

                    <div class="form-group">
                        <label><i class="fas fa-tag"></i> Mark Numbers as Donated</label>
                        <input type="text" id="manualNumbers" placeholder="Enter numbers separated by commas (e.g., 9,15,23)" style="margin-bottom: 10px;" maxlength="200">
                        <button class="form-btn btn-danger" onclick="markNumbersAsDonated()">
                            <i class="fas fa-check-circle"></i> Mark as Donated
                        </button>
                    </div>

                    <div style="display: flex; gap: 15px; flex-wrap: wrap; margin-top: 30px;">
                        <button class="form-btn btn-primary" onclick="downloadDonorData()" style="width: auto; padding: 15px 25px;">
                            <i class="fas fa-download"></i> Download CSV
                        </button>
                        <button class="form-btn btn-danger" onclick="resetAllData()" style="width: auto; padding: 15px 25px;">
                            <i class="fas fa-trash-alt"></i> Reset All Data
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <div class="fundraiser-card" id="fundraiserCard">
            <div class="fundraiser-header">
                <div class="profile-container">
                    <div class="profile-image">L</div>
                </div>
                <div class="fundraiser-name">Lilia</div>
                <div class="fundraiser-bio" id="bioDisplay">I'm passionate about serving others and making a difference in the lives of children. This Tanzania mission is close to my heart!</div>
            </div>
            
            <div class="progress-section">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                </div>
                <div class="progress-text" id="progressText">$0 / $3,500</div>
                <div class="progress-percentage" id="progressPercentage">0% to goal</div>
            </div>
            
            <div class="number-section">
                <h3 class="section-title"><i class="fas fa-hashtag"></i> Pick Your Number(s)</h3>
                <div class="number-grid" id="numberGrid">
                    <!-- Numbers 1-80 will be generated here -->
                </div>
            </div>
            
            <div class="donation-summary" id="donationSummary">
                <h3>Selected Amount: $0</h3>
            </div>
            
            <div class="payment-methods">
                <div class="payment-btn" onclick="openVenmo('https://venmo.com/LiliaMission')">
                    üíú Venmo 
                </div>
                <div class="payment-btn" onclick="openCashApp('https://cash.app/$LiliaTanzania')">
                    üíö CashApp 
                </div>
                <div class="payment-btn" onclick="openPayPal('https://www.paypal.com/donate/?hosted_button_id=SKVSD3FNPFCAG')">
                    üíô PayPal 
                </div>
                <div class="payment-btn" onclick="selectPayment('zelle')">
                 <span>Zelle<br>555-123-4567</span>
                </div>
            </div>
            
            <button class="donate-btn" onclick="processDonation()" disabled id="donateBtn">
                <i class="fas fa-arrow-right"></i> Next
            </button>
        </div>
    </div>

    <!-- Payment Modal -->
    <div class="modal" id="paymentModal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal()">&times;</span>
            <h2><i class="fas fa-gift"></i> Complete Your Donation</h2>
            <div id="paymentInfo"></div>
            
            <div style="background: #f8f9fa; padding: 25px; border-radius: 12px; margin: 30px 0; text-align: left;">
                <h4 style="margin-bottom: 20px; text-align: center; color: var(--primary);"><i class="fas fa-user-circle"></i> Donor Information</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--dark);">Full Name *</label>
                        <input type="text" id="donorName" required style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-family: 'Poppins', sans-serif;">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--dark);">Phone Number *</label>
                        <input type="tel" id="donorPhone" required style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-family: 'Poppins', sans-serif;">
                    </div>
                </div>
                <div>
                    <label style="display: block; margin-bottom: 8px; font-weight: 600; color: var(--dark);">Mailing Address *</label>
                    <textarea id="donorAddress" required rows="3" style="width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-family: 'Poppins', sans-serif;" placeholder="Street Address, City, State, ZIP"></textarea>
                </div>
            </div>
            
            <p style="margin-top: 20px; color: var(--text);"><i class="fas fa-info-circle"></i> After sending payment and filling out your information, click the button below.</p>
            <button class="form-btn btn-success" onclick="confirmDonation()" id="confirmBtn">
                <i class="fas fa-check"></i> I've Sent Payment
            </button>
        </div>
    </div>

    <script>
        // Security Configuration
        const ADMIN_PASSWORD = 'lilia#2024'; // Admin password for Lilia
        
        // Fundraiser data - stored in localStorage
        let fundraiserData = {
            name: "Lilia",
            bio: "I'm passionate about serving others and making a difference in the lives of children. This Tanzania mission is close to my heart!",
            raised: 0,
            goal: 3500,
            donations: {},
            completed: false
        };

        let donorData = [];
        let selectedNumbers = [];
        let selectedPayment = '';
        let tapCount = 0;
        let isAuthenticated = false;

        // Load data from localStorage
        function loadData() {
            const saved = localStorage.getItem('lilia_fundraiser_data');
            if (saved) {
                fundraiserData = JSON.parse(saved);
            }
            
            const savedDonors = localStorage.getItem('lilia_donor_data');
            if (savedDonors) {
                donorData = JSON.parse(savedDonors);
            }
        }

        // Save data to localStorage
        function saveData() {
            localStorage.setItem('lilia_fundraiser_data', JSON.stringify(fundraiserData));
            localStorage.setItem('lilia_donor_data', JSON.stringify(donorData));
        }

        // Security Functions
        function sanitizeInput(input) {
            if (typeof input !== 'string') return '';
            return input.replace(/[<>\"'&]/g, function(match) {
                const map = {
                    '<': '&lt;',
                    '>': '&gt;',
                    '"': '&quot;',
                    "'": '&#x27;',
                    '&': '&amp;'
                };
                return map[match];
            }).trim();
        }

        function authenticateAdmin() {
            const password = document.getElementById('adminPassword').value;
            const authError = document.getElementById('authError');
            
            if (password === ADMIN_PASSWORD) {
                isAuthenticated = true;
                document.getElementById('authForm').style.display = 'none';
                document.getElementById('adminDashboard').style.display = 'block';
                document.getElementById('adminPassword').value = '';
                updateAdminStats();
            } else {
                authError.textContent = 'Invalid admin password';
                authError.style.display = 'block';
                setTimeout(() => {
                    authError.style.display = 'none';
                }, 3000);
            }
        }

        // Initialize page
        function init() {
            loadData();
            generateNumberGrid();
            updateProgress();
            updateDonationSummary();
            setupMobileAdminAccess();
        }

        function generateNumberGrid() {
            const grid = document.getElementById('numberGrid');
            grid.innerHTML = '';
            
            for (let i = 1; i <= 80; i++) {
                const button = document.createElement('div');
                button.className = 'number-button';
                button.textContent = i;
                button.title = `Donate $${i}`;
                
                if (fundraiserData.donations[i]) {
                    button.classList.add('donated');
                    button.style.pointerEvents = 'none';
                } else if (selectedNumbers.includes(i)) {
                    button.classList.add('selected');
                }
                
                button.onclick = () => toggleNumber(i);
                grid.appendChild(button);
            }
        }

        function toggleNumber(number) {
            if (fundraiserData.donations[number]) return;
            
            const index = selectedNumbers.indexOf(number);
            if (index > -1) {
                selectedNumbers.splice(index, 1);
            } else {
                selectedNumbers.push(number);
            }
            
            generateNumberGrid();
            updateDonationSummary();
        }

        function updateDonationSummary() {
            const total = selectedNumbers.reduce((sum, num) => sum + num, 0);
            document.getElementById('donationSummary').innerHTML = `<h3>Selected Amount: $${total}</h3>`;
            
            const donateBtn = document.getElementById('donateBtn');
            if (selectedNumbers.length === 0) {
                donateBtn.innerHTML = '<i class="fas fa-arrow-right"></i> Next';
                donateBtn.disabled = true;
            } else if (!selectedPayment) {
                donateBtn.innerHTML = '<i class="fas fa-arrow-right"></i> Next';
                donateBtn.disabled = true;
            } else {
                donateBtn.innerHTML = `<i class="fas fa-arrow-right"></i> Next ($${total})`;
                donateBtn.disabled = false;
            }
        }

        function updateProgress() {
            const percentage = Math.min((fundraiserData.raised / fundraiserData.goal) * 100, 100);
            document.getElementById('progressFill').style.width = `${percentage}%`;
            document.getElementById('progressText').textContent = `$${fundraiserData.raised} / $${fundraiserData.goal.toLocaleString()}`;
            document.getElementById('progressPercentage').textContent = `${Math.round(percentage)}% to goal`;
            
            if (isAuthenticated) {
                document.getElementById('bioDisplay').textContent = fundraiserData.bio;
                document.getElementById('bioText').value = fundraiserData.bio;
            }
            
            if (fundraiserData.raised >= fundraiserData.goal) {
                document.getElementById('fundraiserCard').classList.add('completed');
                document.getElementById('numberGrid').style.display = 'none';
                document.querySelector('.payment-methods').style.display = 'none';
                document.getElementById('donateBtn').style.display = 'none';
                document.getElementById('donationSummary').innerHTML = '<div class="success-message">üéâ Goal Reached! Thank you for helping Lilia get to Tanzania!</div>';
            }
        }

        function selectPayment(method) {
            selectedPayment = method;
            document.querySelectorAll('.payment-btn').forEach(btn => btn.classList.remove('selected'));
            event.target.classList.add('selected');
            updateDonationSummary();
        }

        function openVenmo(url) {
            window.open('https://venmo.com/Lilia-Jones-2', '_blank');
            selectPayment('venmo');
        }

        function openCashApp(url) {
            window.open('https://cash.app/$itsliliuh', '_blank');
            selectPayment('cashapp');
        }

        function openPayPal(url) {
            window.open(url, '_blank');
            selectPayment('paypal');
        }

        function processDonation() {
            if (selectedNumbers.length === 0 || !selectedPayment) return;
            
            const total = selectedNumbers.reduce((sum, num) => sum + num, 0);
            showPaymentModal(selectedPayment, total);
        }

        function showPaymentModal(method, amount) {
            const modal = document.getElementById('paymentModal');
            const info = document.getElementById('paymentInfo');
            
            const paymentMethods = {
                'venmo': { handle: '@Lilia-Jones-2', name: 'Venmo' },
                'cashapp': { handle: '$itsliliuh', name: 'CashApp' },
                'paypal': { handle: 'Use PayPal link', name: 'PayPal' },
                'zelle': { handle: '512-585-0543', name: 'Zelle' }
            };
            
            const payment = paymentMethods[method];
            if (!payment) return;
            
            info.innerHTML = `
                <h3 style="color: var(--primary);">Send $${amount} to Lilia</h3>
                <p style="margin: 15px 0; font-size: 1.1rem;"><strong>${payment.name}:</strong> ${payment.handle}</p>
                <p style="margin-bottom: 20px;"><strong>Memo:</strong> Tanzania Mission Trip</p>
                <div style="background: #f0f5ff; padding: 20px; border-radius: 10px; margin: 25px 0; border-left: 4px solid var(--accent);">
                    <p style="font-size: 1.1rem;">Please send <strong>$${amount}</strong> using ${payment.name}</p>
                </div>
            `;
            
            modal.style.display = 'block';
        }

        function confirmDonation() {
            const donorName = sanitizeInput(document.getElementById('donorName').value);
            const donorPhone = sanitizeInput(document.getElementById('donorPhone').value);
            const donorAddress = sanitizeInput(document.getElementById('donorAddress').value);

            if (!donorName || !donorPhone || !donorAddress) {
                alert('Please fill out all donor information fields.');
                return;
            }

            const total = selectedNumbers.reduce((sum, num) => sum + num, 0);

            // Store locally
            selectedNumbers.forEach(num => fundraiserData.donations[num] = true);
            fundraiserData.raised += total;

            const donation = {
                amount: total,
                numbers: selectedNumbers.join(", "),
                method: selectedPayment,
                donorName,
                donorPhone,
                donorAddress,
                date: new Date().toLocaleDateString(),
                timestamp: Date.now()
            };

            // Build and submit form
            const form = document.createElement("form");
            form.action = "https://script.google.com/macros/s/AKfycbzTuWjgKz_VBtd7QOeX4hfMY6TWwAjYgcZTjrh81s5mro4Vka4e2zIL7G79dR4UfglK/exec";
            form.method = "POST";
            form.style.display = "none";

            for (let key in donation) {
                const input = document.createElement("input");
                input.type = "hidden";
                input.name = key;
                input.value = donation[key];
                form.appendChild(input);
            }

            document.body.appendChild(form);
            form.submit();

            // Local cleanup
            donorData.push(donation);
            saveData();
            selectedNumbers = [];
            selectedPayment = '';
            document.getElementById('donorName').value = '';
            document.getElementById('donorPhone').value = '';
            document.getElementById('donorAddress').value = '';
            closeModal();
            generateNumberGrid();
            updateProgress();
            updateDonationSummary();
            
            // Show success message
            alert(`Thank you for your donation of $${total}! Your support means the world to Lilia.`);
        }

        function closeModal() {
            document.getElementById('paymentModal').style.display = 'none';
        }

        // Admin Functions
        function setupMobileAdminAccess() {
            const fundraiserName = document.querySelector('.fundraiser-name');
            fundraiserName.addEventListener('click', function() {
                tapCount++;
                if (tapCount === 7) {
                    const adminPanel = document.getElementById('adminPanel');
                    adminPanel.style.display = adminPanel.style.display === 'none' ? 'block' : 'none';
                    tapCount = 0;
                    
                    this.style.color = '#e84393';
                    setTimeout(() => {
                        this.style.color = '#8e44ad';
                    }, 1000);
                }
                
                setTimeout(() => {
                    tapCount = 0;
                }, 3000);
            });
        }

        function toggleAdmin() {
            const content = document.getElementById('adminContent');
            content.classList.toggle('active');
        }

        function updateAdminStats() {
            if (!isAuthenticated) return;
            document.getElementById('donationCount').textContent = donorData.length;
            document.getElementById('totalRaised').textContent = fundraiserData.raised;
            document.getElementById('lastUpdated').textContent = new Date().toLocaleString();
        }

        function updateBio() {
            if (!isAuthenticated) return;
            
            const newBio = sanitizeInput(document.getElementById('bioText').value);
            fundraiserData.bio = newBio;
            document.getElementById('bioDisplay').textContent = newBio;
            saveData();
            
            // Show success notification
            const successMsg = document.createElement('div');
            successMsg.className = 'status-indicator status-success';
            successMsg.innerHTML = '<i class="fas fa-check-circle"></i> Bio updated successfully!';
            document.getElementById('adminDashboard').prepend(successMsg);
            
            setTimeout(() => {
                successMsg.remove();
            }, 3000);
        }

        function markNumbersAsDonated() {
            if (!isAuthenticated) return;
            
            const input = sanitizeInput(document.getElementById('manualNumbers').value);
            if (!input) {
                alert('Please enter at least one number.');
                return;
            }
            
            const numbers = input.split(',')
                .map(n => parseInt(n.trim()))
                .filter(n => !isNaN(n) && n >= 1 && n <= 80);
            
            if (numbers.length === 0) {
                alert('Please enter valid numbers between 1 and 80.');
                return;
            }
            
            let newlyMarked = [];
            
            numbers.forEach(num => {
                if (!fundraiserData.donations[num]) {
                    fundraiserData.donations[num] = true;
                    newlyMarked.push(num);
                }
            });
            
            if (newlyMarked.length > 0) {
                const total = newlyMarked.reduce((sum, num) => sum + num, 0);
                fundraiserData.raised += total;
                
                // Record manual entry
                const donation = {
                    amount: total,
                    numbers: newlyMarked,
                    method: 'Manual Entry (Admin)',
                    timestamp: Date.now(),
                    date: new Date().toLocaleDateString(),
                    donorName: 'Manual Entry',
                    donorPhone: 'N/A',
                    donorAddress: 'N/A'
                };
                
                donorData.push(donation);
                saveData();
                
                generateNumberGrid();
                updateProgress();
                updateAdminStats();
                
                // Show success notification
                const successMsg = document.createElement('div');
                successMsg.className = 'status-indicator status-success';
                successMsg.innerHTML = `<i class="fas fa-check-circle"></i> Marked numbers ${newlyMarked.join(', ')} as donated!`;
                document.getElementById('adminDashboard').prepend(successMsg);
                
                setTimeout(() => {
                    successMsg.remove();
                }, 3000);
            }
            
            document.getElementById('manualNumbers').value = '';
        }

        function downloadDonorData() {
            if (!isAuthenticated || donorData.length === 0) {
                alert('No donation data to download yet.');
                return;
            }
            
            const csvContent = "data:text/csv;charset=utf-8," + 
                "Fundraiser,Amount,Numbers,Payment Method,Date,Timestamp,Donor Name,Phone,Address\n" +
                donorData.map(d => `Lilia,$${d.amount},"${d.numbers.join(';')}",${d.method},${d.date},${d.timestamp},"${d.donorName}","${d.donorPhone}","${d.donorAddress.replace(/"/g, '""')}"`).join("\n");
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", `lilia_donations_${new Date().toISOString().split('T')[0]}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function resetAllData() {
            if (!isAuthenticated) return;
            
            if (confirm('‚ö†Ô∏è This will delete ALL donation data. Are you sure?')) {
                fundraiserData = {
                    name: "Lilia",
                    bio: "I'm passionate about serving others and making a difference in the lives of children. This Tanzania mission is close to my heart!",
                    raised: 0,
                    goal: 3500,
                    donations: {},
                    completed: false
                };
                donorData = [];
                
                saveData();
                generateNumberGrid();
                updateProgress();
                updateAdminStats();
                
                alert('‚úÖ All data has been reset.');
            }
        }

        // Keyboard shortcut for admin panel
        document.addEventListener('keydown', function(event) {
            if (event.ctrlKey && event.shiftKey && event.key === 'A') {
                const adminPanel = document.getElementById('adminPanel');
                adminPanel.style.display = adminPanel.style.display === 'none' ? 'block' : 'none';
            }
        });

        // Initialize the page
        window.onload = init;
    </script>
</body>
</html>

