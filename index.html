<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Help Lilia Get to Tanzania - Mission Trip Fundraiser</title>
    
    <!-- Security Headers -->
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:;">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            background: white;
            padding: 40px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .header h1 {
            font-size: 2.5em;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .header h2 {
            color: #e74c3c;
            font-size: 1.5em;
            margin-bottom: 20px;
        }

        .mission-info {
            background: #f8f9fa;
            padding: 25px;
            border-radius: 10px;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .mission-info h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .admin-panel {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .admin-toggle {
            background: #3498db;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-bottom: 20px;
        }

        .admin-content {
            display: none;
        }

        .admin-content.active {
            display: block;
        }

        .form-group {
            margin-bottom: 15px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #2c3e50;
        }

        .form-group textarea, .form-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            min-height: 40px;
        }

        .form-group textarea {
            min-height: 80px;
        }

        .fundraiser-card {
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .fundraiser-card.completed {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
        }

        .fundraiser-header {
            text-align: center;
            margin-bottom: 25px;
        }

        .fundraiser-name {
            font-size: 2em;
            font-weight: bold;
            margin-bottom: 15px;
            color: #2c3e50;
            cursor: pointer;
        }

        .fundraiser-bio {
            color: #666;
            font-size: 1.1em;
            margin-bottom: 20px;
            line-height: 1.5;
        }

        .progress-section {
            margin-bottom: 25px;
        }

        .progress-bar {
            width: 100%;
            height: 25px;
            background: #ecf0f1;
            border-radius: 15px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            transition: width 0.3s ease;
            border-radius: 15px;
        }

        .progress-text {
            text-align: center;
            font-weight: bold;
            font-size: 1.2em;
            margin-bottom: 10px;
        }

        .progress-percentage {
            text-align: center;
            font-size: 1.1em;
            color: #666;
        }

        .number-grid {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 8px;
            margin-bottom: 25px;
        }

        .number-button {
            aspect-ratio: 1;
            border: 2px solid #3498db;
            background: white;
            color: #3498db;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.9em;
        }

        .number-button:hover {
            background: #3498db;
            color: white;
            transform: scale(1.05);
        }

        .number-button.selected {
            background: #27ae60;
            border-color: #27ae60;
            color: white;
        }

        .number-button.donated {
            background: #95a5a6;
            border-color: #95a5a6;
            color: white;
            cursor: not-allowed;
        }

        .donation-summary {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }

        .donation-summary h3 {
            font-size: 1.5em;
            color: #2c3e50;
        }

        .payment-methods {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 25px;
        }

        .payment-btn {
            padding: 20px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 1.1em;
        }

        .payment-btn:hover {
            border-color: #3498db;
            background: #f8f9fa;
        }

        .payment-btn.selected {
            border-color: #27ae60;
            background: #27ae60;
            color: white;
        }

        .donate-btn {
            width: 100%;
            padding: 20px;
            background: linear-gradient(45deg, #27ae60, #2ecc71);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.3em;
            font-weight: bold;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .donate-btn:hover {
            transform: translateY(-2px);
        }

        .donate-btn:disabled {
            background: #95a5a6;
            cursor: not-allowed;
            transform: none;
        }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.8);
            z-index: 1000;
        }

        .modal-content {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            padding: 40px;
            border-radius: 15px;
            max-width: 500px;
            width: 90%;
            text-align: center;
        }

        .close-btn {
            position: absolute;
            top: 15px;
            right: 20px;
            font-size: 30px;
            cursor: pointer;
            color: #999;
        }

        .success-message {
            background: linear-gradient(135deg, #2ecc71, #27ae60);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            text-align: center;
        }

        .status-indicator {
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            text-align: center;
            font-weight: bold;
        }

        .status-success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .status-error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .auth-form {
            background: #fff3cd;
            border: 1px solid #ffeeba;
            padding: 20px;
            border-radius: 10px;
            margin: 15px 0;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 2em;
            }
            
            .number-grid {
                grid-template-columns: repeat(4, 1fr);
            }
            
            .payment-methods {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåç Help Lilia Get to Tanzania</h1>
            <h2>Mission Trip to Arusha ‚Ä¢ November 20-30, 2024</h2>
            <div class="mission-info">
                <h3>Our Mission</h3>
                <p>We'll be ministering to over 107,000 children in Arusha, Tanzania and conducting projects at a local school (possibly painting classrooms, fixing desks, and other vital improvements to create a better learning environment).</p>
                <p><strong>Your donation helps cover:</strong> Flights, accommodation, meals, project supplies, and materials for the children.</p>
                <div style="background: #e8f4f8; padding: 15px; border-radius: 8px; margin-top: 15px; border-left: 4px solid #3498db;">
                    <p><strong>"Pick A Number"</strong> to represent the donation amount that you would like to give (you can choose multiple numbers to get the sum of your choice). Afterwards, scroll to the bottom to select payment option and press "Next".</p>
                </div>
            </div>
        </div>

        <div class="admin-panel" id="adminPanel" style="display: none;">
            <button class="admin-toggle" onclick="toggleAdmin()">üõ†Ô∏è Admin Panel</button>
            <div class="admin-content" id="adminContent">
                <h3>Admin Dashboard - Lilia</h3>
                
                <!-- Admin Authentication -->
                <div class="auth-form" id="authForm">
                    <h4>üîê Admin Authentication Required</h4>
                    <div class="form-group">
                        <label>Admin Password:</label>
                        <input type="password" id="adminPassword" placeholder="Enter admin password">
                        <button onclick="authenticateAdmin()" style="margin-top: 10px; padding: 10px; background: #e74c3c; color: white; border: none; border-radius: 5px; width: 100%;">üîì Unlock Admin Panel</button>
                    </div>
                    <div id="authError" class="status-indicator status-error" style="display: none;"></div>
                </div>

                <div id="adminDashboard" style="display: none;">
                    <div class="form-group">
                        <label>üìä Stats</label>
                        <p><strong>Total Donations:</strong> <span id="donationCount">0</span></p>
                        <p><strong>Total Raised:</strong> $<span id="totalRaised">0</span></p>
                        <p><strong>Last Updated:</strong> <span id="lastUpdated">Never</span></p>
                    </div>

                    <div class="form-group">
                        <label>Update Your Bio</label>
                        <textarea id="bioText" maxlength="500">I believe in the power of love and service to transform communities. This opportunity to serve in Tanzania fills my heart with joy!</textarea>
                        <button onclick="updateBio()" style="margin-top: 10px; padding: 10px; background: #3498db; color: white; border: none; border-radius: 5px;">Update Bio</button>
                    </div>

                    <div class="form-group">
                        <label>Mark Numbers as Donated</label>
                        <input type="text" id="manualNumbers" placeholder="Enter numbers separated by commas (e.g., 9,15,23)" style="margin-bottom: 10px;" maxlength="200">
                        <button onclick="markNumbersAsDonated()" style="padding: 10px; background: #e74c3c; color: white; border: none; border-radius: 5px; width: 100%;">Mark as Donated</button>
                    </div>

                    <button onclick="downloadDonorData()" style="padding: 15px 30px; background: #f39c12; color: white; border: none; border-radius: 10px; font-size: 16px; cursor: pointer; margin: 5px;">üì• Download CSV</button>
                    <button onclick="resetAllData()" style="padding: 15px 30px; background: #dc3545; color: white; border: none; border-radius: 10px; font-size: 16px; cursor: pointer; margin: 5px;">üóëÔ∏è Reset All Data</button>
                </div>
            </div>
        </div>

        <div class="fundraiser-card" id="fundraiserCard">
            <div class="fundraiser-header">
                <div class="fundraiser-name">Lilia</div>
                <div class="fundraiser-bio" id="bioDisplay">I believe in the power of love and service to transform communities. This opportunity to serve in Tanzania fills my heart with joy!</div>
            </div>
            
            <div class="progress-section">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                </div>
                <div class="progress-text" id="progressText">$0 / $3,500</div>
                <div class="progress-percentage" id="progressPercentage">0% to goal</div>
            </div>
            
            <div class="number-grid" id="numberGrid">
                <!-- Numbers 1-80 will be generated here -->
            </div>
            
            <div class="donation-summary" id="donationSummary">
                <h3>Selected Amount: $0</h3>
            </div>
            
            <div class="payment-methods">
                <div class="payment-btn" onclick="openVenmo('https://venmo.com/u/Lilia-Jones-2')">
                    üíú Venmo
                </div>
                <div class="payment-btn" onclick="openCashApp('https://cash.app/$itsliliuh')">
                    üíö CashApp
                </div>
                <div class="payment-btn" onclick="openPayPal('jonesoverseas4_3@yahoo.com')">
                    üíô PayPal
                </div>
                <div class="payment-btn" onclick="selectPayment('zelle')">
                    üü° Zelle<br>512-585-4106
                </div>
            </div>
            
            <button class="donate-btn" onclick="processDonation()" disabled id="donateBtn">
                Next
            </button>
        </div>
    </div>

    <!-- Payment Modal -->
    <div class="modal" id="paymentModal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal()">&times;</span>
            <h2>Complete Your Donation</h2>
            <div id="paymentInfo"></div>
            
            <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0; text-align: left;">
                <h4 style="margin-bottom: 15px; text-align: center;">Donor Information</h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-bottom: 15px;">
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: bold;">Full Name *</label>
                        <input type="text" id="donorName" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px;" maxlength="100">
                    </div>
                    <div>
                        <label style="display: block; margin-bottom: 5px; font-weight: bold;">Phone Number *</label>
                        <input type="tel" id="donorPhone" required style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px;" maxlength="20">
                    </div>
                </div>
                <div>
                    <label style="display: block; margin-bottom: 5px; font-weight: bold;">Mailing Address *</label>
                    <textarea id="donorAddress" required rows="3" style="width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 5px;" placeholder="Street Address, City, State, ZIP" maxlength="300"></textarea>
                </div>
            </div>
            
            <p style="margin-top: 20px; color: #666;">After sending payment and filling out your information, click the button below.</p>
            <button onclick="confirmDonation()" id="confirmBtn" style="padding: 15px 30px; background: #2ecc71; color: white; border: none; border-radius: 10px; font-size: 16px; cursor: pointer; margin-top: 20px;">I've Sent Payment</button>
        </div>
    </div>

    <script>
        // Security Configuration
        const ADMIN_PASSWORD = 'lilia2024'; // Change this password!
        
        // Fundraiser data - stored in localStorage
        let fundraiserData = {
            name: "Lilia",
            bio: "I believe in the power of love and service to transform communities. This opportunity to serve in Tanzania fills my heart with joy!",
            raised: 0,
            goal: 3500,
            donations: {},
            completed: false
        };

        let donorData = [];
        let selectedNumbers = [];
        let selectedPayment = '';
        let tapCount = 0;
        let isAuthenticated = false;

        // Load data from localStorage
        function loadData() {
            const saved = localStorage.getItem('lilia_fundraiser_data');
            if (saved) {
                fundraiserData = JSON.parse(saved);
            }
            
            const savedDonors = localStorage.getItem('lilia_donor_data');
            if (savedDonors) {
                donorData = JSON.parse(savedDonors);
            }
        }

        // Save data to localStorage
        function saveData() {
            localStorage.setItem('lilia_fundraiser_data', JSON.stringify(fundraiserData));
            localStorage.setItem('lilia_donor_data', JSON.stringify(donorData));
        }

        // Security Functions
        function sanitizeInput(input) {
            if (typeof input !== 'string') return '';
            return input.replace(/[<>\"'&]/g, function(match) {
                const map = {
                    '<': '&lt;',
                    '>': '&gt;',
                    '"': '&quot;',
                    "'": '&#x27;',
                    '&': '&amp;'
                };
                return map[match];
            }).trim();
        }

        function authenticateAdmin() {
            const password = document.getElementById('adminPassword').value;
            const authError = document.getElementById('authError');
            
            if (password === ADMIN_PASSWORD) {
                isAuthenticated = true;
                document.getElementById('authForm').style.display = 'none';
                document.getElementById('adminDashboard').style.display = 'block';
                document.getElementById('adminPassword').value = '';
                updateAdminStats();
            } else {
                authError.textContent = 'Invalid admin password';
                authError.style.display = 'block';
                setTimeout(() => {
                    authError.style.display = 'none';
                }, 3000);
            }
        }

        // Initialize page
        function init() {
            loadData();
            generateNumberGrid();
            updateProgress();
            updateDonationSummary();
            setupMobileAdminAccess();
        }

        function generateNumberGrid() {
            const grid = document.getElementById('numberGrid');
            grid.innerHTML = '';
            
            for (let i = 1; i <= 80; i++) {
                const button = document.createElement('div');
                button.className = 'number-button';
                button.textContent = i;
                button.title = `Donate $${i}`;
                
                if (fundraiserData.donations[i]) {
                    button.classList.add('donated');
                    button.style.pointerEvents = 'none';
                } else if (selectedNumbers.includes(i)) {
                    button.classList.add('selected');
                }
                
                button.onclick = () => toggleNumber(i);
                grid.appendChild(button);
            }
        }

        function toggleNumber(number) {
            if (fundraiserData.donations[number]) return;
            
            const index = selectedNumbers.indexOf(number);
            if (index > -1) {
                selectedNumbers.splice(index, 1);
            } else {
                selectedNumbers.push(number);
            }
            
            generateNumberGrid();
            updateDonationSummary();
        }

        function updateDonationSummary() {
            const total = selectedNumbers.reduce((sum, num) => sum + num, 0);
            document.getElementById('donationSummary').innerHTML = `<h3>Selected Amount: $${total}</h3>`;
            
            const donateBtn = document.getElementById('donateBtn');
            if (selectedNumbers.length === 0) {
                donateBtn.textContent = 'Next';
                donateBtn.disabled = true;
            } else if (!selectedPayment) {
                donateBtn.textContent = 'Next';
                donateBtn.disabled = true;
            } else {
                donateBtn.textContent = `Next ($${total})`;
                donateBtn.disabled = false;
            }
        }

        function updateProgress() {
            const percentage = Math.min((fundraiserData.raised / fundraiserData.goal) * 100, 100);
            document.getElementById('progressFill').style.width = `${percentage}%`;
            document.getElementById('progressText').textContent = `$${fundraiserData.raised} / $${fundraiserData.goal.toLocaleString()}`;
            document.getElementById('progressPercentage').textContent = `${Math.round(percentage)}% to goal`;
            
            if (isAuthenticated) {
                document.getElementById('bioDisplay').textContent = fundraiserData.bio;
                document.getElementById('bioText').value = fundraiserData.bio;
            }
            
            if (fundraiserData.raised >= fundraiserData.goal) {
                document.getElementById('fundraiserCard').classList.add('completed');
                document.getElementById('numberGrid').style.display = 'none';
                document.querySelector('.payment-methods').style.display = 'none';
                document.getElementById('donateBtn').style.display = 'none';
                document.getElementById('donationSummary').innerHTML = '<div class="success-message">üéâ Goal Reached! Thank you for helping me get to Tanzania!</div>';
            }
        }

        function selectPayment(method) {
            selectedPayment = method;
            document.querySelectorAll('.payment-btn').forEach(btn => btn.classList.remove('selected'));
            event.target.classList.add('selected');
            updateDonationSummary();
        }

        function openVenmo(url) {
            window.open(url, '_blank');
            selectPayment('venmo');
        }

        function openCashApp(url) {
            window.open(url, '_blank');
            selectPayment('cashapp');
        }

        function openPayPal(email) {
            window.open(`https://www.paypal.com/paypalme/${email}`, '_blank');
            selectPayment('paypal');
        }

        function processDonation() {
            if (selectedNumbers.length === 0 || !selectedPayment) return;
            
            const total = selectedNumbers.reduce((sum, num) => sum + num, 0);
            showPaymentModal(selectedPayment, total);
        }

        function showPaymentModal(method, amount) {
            const modal = document.getElementById('paymentModal');
            const info = document.getElementById('paymentInfo');
            
            const paymentMethods = {
                'venmo': { handle: '@Lilia-Jones2', name: 'Venmo' },
                'cashapp': { handle: '$itsliliuh', name: 'CashApp' },
                'paypal': { handle: 'jonesoverseas4_3@yahoo.com', name: 'PayPal' },
                'zelle': { handle: '512-585-4106', name: 'Zelle' }
            };
            
            const payment = paymentMethods[method];
            if (!payment) return;
            
            info.innerHTML = `
                <h3>Send $${amount} to Lilia</h3>
                <p><strong>${payment.name}:</strong> ${payment.handle}</p>
                <p><strong>Memo:</strong> Tanzania Mission Trip</p>
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
                    <p>Please send <strong>$${amount}</strong> using ${payment.name}</p>
                </div>
            `;
            
            modal.style.display = 'block';
        }

        function confirmDonation() {
            const donorName = sanitizeInput(document.getElementById('donorName').value);
            const donorPhone = sanitizeInput(document.getElementById('donorPhone').value);
            const donorAddress = sanitizeInput(document.getElementById('donorAddress').value);
            
            if (!donorName || !donorPhone || !donorAddress) {
                alert('Please fill out all donor information fields.');
                return;
            }
            
            const total = selectedNumbers.reduce((sum, num) => sum + num, 0);
            
            // Mark numbers as donated
            selectedNumbers.forEach(num => {
                fundraiserData.donations[num] = true;
            });
            
            fundraiserData.raised += total;
            
            // Create donation record
            const donation = {
                amount: total,
                numbers: [...selectedNumbers],
                method: selectedPayment,
                timestamp: Date.now(),
                date: new Date().toLocaleDateString(),
                donorName: donorName,
                donorPhone: donorPhone,
                donorAddress: donorAddress
            };
            
            donorData.push(donation);
            
            // Save data
            saveData();
            
            // Reset selections
            selectedNumbers = [];
            selectedPayment = '';
            
            // Clear form
            document.getElementById('donorName').value = '';
            document.getElementById('donorPhone').value = '';
            document.getElementById('donorAddress').value = '';
            
            closeModal();
            
            // Update UI
            generateNumberGrid();
            updateProgress();
            updateDonationSummary();
            
            alert('‚úÖ Thank you! Your donation has been recorded.');
        }

        function closeModal() {
            document.getElementById('paymentModal').style.display = 'none';
        }

        // Admin Functions
        function setupMobileAdminAccess() {
            const fundraiserName = document.querySelector('.fundraiser-name');
            fundraiserName.addEventListener('click', function() {
                tapCount++;
                if (tapCount === 7) {
                    const adminPanel = document.getElementById('adminPanel');
                    adminPanel.style.display = adminPanel.style.display === 'none' ? 'block' : 'none';
                    tapCount = 0;
                    
                    this.style.color = '#e74c3c';
                    setTimeout(() => {
                        this.style.color = '#2c3e50';
                    }, 1000);
                }
                
                setTimeout(() => {
                    tapCount = 0;
                }, 3000);
            });
        }

        function toggleAdmin() {
            const content = document.getElementById('adminContent');
            content.classList.toggle('active');
        }

        function updateAdminStats() {
            if (!isAuthenticated) return;
            document.getElementById('donationCount').textContent = donorData.length;
            document.getElementById('totalRaised').textContent = fundraiserData.raised;
            document.getElementById('lastUpdated').textContent = new Date().toLocaleString();
        }

        function updateBio() {
            if (!isAuthenticated) return;
            
            const newBio = sanitizeInput(document.getElementById('bioText').value);
            fundraiserData.bio = newBio;
            document.getElementById('bioDisplay').textContent = newBio;
            saveData();
            alert('‚úÖ Bio updated!');
        }

        function markNumbersAsDonated() {
            if (!isAuthenticated) return;
            
            const input = sanitizeInput(document.getElementById('manualNumbers').value);
            if (!input) {
                alert('Please enter at least one number.');
                return;
            }
            
            const numbers = input.split(',')
                .map(n => parseInt(n.trim()))
                .filter(n => !isNaN(n) && n >= 1 && n <= 80);
            
            if (numbers.length === 0) {
                alert('Please enter valid numbers between 1 and 80.');
                return;
            }
            
            let newlyMarked = [];
            
            numbers.forEach(num => {
                if (!fundraiserData.donations[num]) {
                    fundraiserData.donations[num] = true;
                    newlyMarked.push(num);
                }
            });
            
            if (newlyMarked.length > 0) {
                const total = newlyMarked.reduce((sum, num) => sum + num, 0);
                fundraiserData.raised += total;
                
                // Record manual entry
                const donation = {
                    amount: total,
                    numbers: newlyMarked,
                    method: 'Manual Entry (Admin)',
                    timestamp: Date.now(),
                    date: new Date().toLocaleDateString(),
                    donorName: 'Manual Entry',
                    donorPhone: 'N/A',
                    donorAddress: 'N/A'
                };
                
                donorData.push(donation);
                saveData();
                
                generateNumberGrid();
                updateProgress();
                updateAdminStats();
                
                alert(`‚úÖ Marked numbers ${newlyMarked.join(', ')} as donated!`);
            }
            
            document.getElementById('manualNumbers').value = '';
        }

        function downloadDonorData() {
            if (!isAuthenticated || donorData.length === 0) {
                alert('No donation data to download yet.');
                return;
            }
            
            const csvContent = "data:text/csv;charset=utf-8," + 
                "Fundraiser,Amount,Numbers,Payment Method,Date,Timestamp,Donor Name,Phone,Address\n" +
                donorData.map(d => `Lilia,$${d.amount},"${d.numbers.join(';')}",${d.method},${d.date},${d.timestamp},"${d.donorName}","${d.donorPhone}","${d.donorAddress.replace(/"/g, '""')}"`).join("\n");
            
            const encodedUri = encodeURI(csvContent);
            const link = document.createElement("a");
            link.setAttribute("href", encodedUri);
            link.setAttribute("download", `lilia_donations_${new Date().toISOString().split('T')[0]}.csv`);
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        function resetAllData() {
            if (!isAuthenticated) return;
            
            if (confirm('‚ö†Ô∏è This will delete ALL donation data. Are you sure?')) {
                fundraiserData = {
                    name: "Lilia",
                    bio: "I believe in the power of love and service to transform communities. This opportunity to serve in Tanzania fills my heart with joy!",
                    raised: 0,
                    goal: 3500,
                    donations: {},
                    completed: false
                };
                donorData = [];
                
                saveData();
                generateNumberGrid();
                updateProgress();
                updateAdminStats();
                
                alert('‚úÖ All data has been reset.');
            }
        }

        // Keyboard shortcut for admin panel
        document.addEventListener('keydown', function(event) {
            if (event.ctrlKey && event.shiftKey && event.key === 'A') {
                const adminPanel = document.getElementById('adminPanel');
                adminPanel.style.display = adminPanel.style.display === 'none' ? 'block' : 'none';
            }
        });

        // Initialize the page
        init();
    </script>
</body>
</html>
